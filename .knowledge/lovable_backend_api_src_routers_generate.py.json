{"is_source_file": true, "format": "Python", "description": "This file defines API routes related to a generation process, including starting a generation task via HTTP POST and establishing a WebSocket stream for real-time events. It contains Pydantic models for request and response payloads, incorporates dependencies for user authentication, and interacts with a generation service to manage tasks and stream events.", "external_files": ["src.routers.auth", "src.services.generation_service"], "external_methods": ["get_current_user", "generation_service.create_task", "generation_service.run_task", "generation_service.get_task_owner", "generation_service.stream_events"], "published": ["start_generation", "ws_stream_generation"], "classes": [{"name": "GenerateRequest", "description": "Payload to initiate a generation task containing prompt, project ID, and chat session ID."}, {"name": "GenerateResponse", "description": "Response containing task ID and WebSocket URL after starting a generation task."}], "methods": [{"name": "GenerateResponse start_generation( payload: GenerateRequest, current_user: UserPublic = Depends(get_current_user), x_forwarded_proto: Optional[str] = Header(default=None), x_forwarded_host: Optional[str] = Header(default=None), )", "description": "Handles POST requests to initiate a new generation task, returns task info including WebSocket URL.", "scope": "", "scopeKind": ""}, {"name": "None ws_stream_generation(websocket: WebSocket, task_id: str = Path(...))", "description": "WebSocket endpoint that streams generation events related to a specific task, with authorization validation.", "scope": "", "scopeKind": ""}], "calls": ["generation_service.create_task", "generation_service.run_task", "generation_service.get_task_owner", "generation_service.stream_events"], "search-terms": ["generate", "generation_service", "WebSocket", "start_generation", "ws_stream_generation", "APIRouter", "Header", "Depends"], "state": 2, "file_id": 14, "knowledge_revision": 35, "git_revision": "", "ctags": [{"_type": "tag", "name": "GenerateRequest", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^class GenerateRequest(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "GenerateResponse", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^class GenerateResponse(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "chat_session_id", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^    chat_session_id: Optional[str] = Field(None, description=\"Associated chat session ID\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "GenerateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "project_id", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^    project_id: Optional[str] = Field(None, description=\"Target project ID\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "GenerateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "prompt", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^    prompt: str = Field(..., description=\"Natural language requirement or change request\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "GenerateRequest", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^router = APIRouter($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "start_generation", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^async def start_generation($/", "language": "Python", "typeref": "typename:GenerateResponse", "kind": "function", "signature": "( payload: GenerateRequest, current_user: UserPublic = Depends(get_current_user), x_forwarded_proto: Optional[str] = Header(default=None), x_forwarded_host: Optional[str] = Header(default=None), )"}, {"_type": "tag", "name": "task_id", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^    task_id: str = Field(..., description=\"ID of the generation task; connect to WS to stream ev/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "GenerateResponse", "scopeKind": "class"}, {"_type": "tag", "name": "websocket_url", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^    websocket_url: str = Field(..., description=\"WebSocket URL to stream generation events\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "GenerateResponse", "scopeKind": "class"}, {"_type": "tag", "name": "ws_stream_generation", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/generate.py", "pattern": "/^async def ws_stream_generation(websocket: WebSocket, task_id: str = Path(...)) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(websocket: WebSocket, task_id: str = Path(...))"}], "hash": "98840e6495a0cb357a6e8c2e4018f1cb", "format-version": 4, "code-base-name": "lovable_backend_api", "filename": "lovable_backend_api/src/routers/generate.py", "fields": [{"name": "Optional[str] chat_session_id", "scope": "GenerateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] project_id", "scope": "GenerateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "str prompt", "scope": "GenerateRequest", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str task_id", "scope": "GenerateResponse", "scopeKind": "class", "description": "unavailable"}, {"name": "str websocket_url", "scope": "GenerateResponse", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"35": ""}]}