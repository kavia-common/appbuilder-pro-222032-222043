{"is_source_file": true, "format": "Python", "description": "This file implements an in-memory service for managing project files, versions, and exporting project data as a zip archive. It defines data classes for files and project states, and provides methods to list, get, create, update, delete, snapshot, restore, and export project files.", "external_files": [], "external_methods": [], "published": ["list_files", "get_file", "upsert_file_by_path", "update_file", "delete_file", "snapshot_version", "list_versions", "get_version", "restore_version", "export_zip_bytes", "project_files_service"], "classes": [{"name": "FileRecord", "description": "Represents an individual project file with id, path, content, and binary status."}, {"name": "VersionRecord", "description": "Represents a snapshot of the project's files at a specific point in time."}, {"name": "ProjectState", "description": "Maintains the current files and their paths for a project."}, {"name": "ProjectFilesService", "description": "Main service class providing in-memory management of project files, versions, and exporting functionality."}], "methods": [{"name": "List[FileRecord] list_files(self, owner_email: str, project_id: str)", "description": "Returns a list of all current files in a project.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "Optional[FileRecord] get_file(self, owner_email: str, project_id: str, file_id: str)", "description": "Retrieves a specific file by its ID.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "FileRecord upsert_file_by_path( self, owner_email: str, project_id: str, path: str, content: str, is_binary: bool = False )", "description": "Creates or updates a file based on its path.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "Optional[FileRecord] update_file( self, owner_email: str, project_id: str, file_id: str, *, path: Optional[str], content: Optional[str], is_binary: Optional[bool] )", "description": "Partially updates attributes of a file identified by its ID.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "bool delete_file(self, owner_email: str, project_id: str, file_id: str)", "description": "Deletes a file from a project.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "VersionRecord snapshot_version( self, owner_email: str, project_id: str, description: Optional[str] )", "description": "Creates a snapshot (version) of all current files with a description.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "List[VersionRecord] list_versions(self, owner_email: str, project_id: str)", "description": "Lists all versions of a project, newest first.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "Optional[VersionRecord] get_version(self, owner_email: str, project_id: str, version_number: int)", "description": "Retrieves a specific version by its number.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "Tuple[List[FileRecord],VersionRecord] restore_version(self, owner_email: str, project_id: str, version_number: int)", "description": "Restores the project files to a specified version snapshot.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "bytes export_zip_bytes(self, owner_email: str, project_id: str)", "description": "Exports current project files as a ZIP archive in bytes.", "scope": "ProjectFilesService", "scopeKind": "class"}, {"name": "None __init__(self)", "scope": "ProjectFilesService", "scopeKind": "class", "description": "unavailable"}, {"name": "ProjectState _get_state(self, owner_email: str, project_id: str)", "scope": "ProjectFilesService", "scopeKind": "class", "description": "unavailable"}], "calls": ["self._get_state", "list", "pop", "pop", "append", "clear", "writestr"], "search-terms": ["ProjectFilesService", "snapshot_version", "export_zip_bytes", "restore_version", "list_files", "upsert_file_by_path", "FileRecord", "VersionRecord", "project_id", "owner_email"], "state": 2, "file_id": 15, "knowledge_revision": 39, "git_revision": "", "ctags": [{"_type": "tag", "name": "FileRecord", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^class FileRecord:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ProjectFilesService", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^class ProjectFilesService:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ProjectState", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^class ProjectState:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "VersionRecord", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^class VersionRecord:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "_get_state", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def _get_state(self, owner_email: str, project_id: str) -> ProjectState:$/", "language": "Python", "typeref": "typename:ProjectState", "kind": "member", "signature": "(self, owner_email: str, project_id: str)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "delete_file", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def delete_file(self, owner_email: str, project_id: str, file_id: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, owner_email: str, project_id: str, file_id: str)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "export_zip_bytes", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def export_zip_bytes(self, owner_email: str, project_id: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "member", "signature": "(self, owner_email: str, project_id: str)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "files", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    files: Dict[str, FileRecord] = field(default_factory=dict)  # key: file_id$/", "language": "Python", "typeref": "typename:Dict[str, FileRecord]", "kind": "variable", "scope": "ProjectState", "scopeKind": "class"}, {"_type": "tag", "name": "files_by_path", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    files_by_path: Dict[str, str] = field(default_factory=dict)  # path -> file_id$/", "language": "Python", "typeref": "typename:Dict[str, str]", "kind": "variable", "scope": "ProjectState", "scopeKind": "class"}, {"_type": "tag", "name": "get_file", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def get_file(self, owner_email: str, project_id: str, file_id: str) -> Optional[FileRecord]:$/", "language": "Python", "typeref": "typename:Optional[FileRecord]", "kind": "member", "signature": "(self, owner_email: str, project_id: str, file_id: str)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "get_version", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def get_version(self, owner_email: str, project_id: str, version_number: int) -> Optional[Ve/", "language": "Python", "typeref": "typename:Optional[VersionRecord]", "kind": "member", "signature": "(self, owner_email: str, project_id: str, version_number: int)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "is_binary", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    is_binary: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "FileRecord", "scopeKind": "class"}, {"_type": "tag", "name": "list_files", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def list_files(self, owner_email: str, project_id: str) -> List[FileRecord]:$/", "language": "Python", "typeref": "typename:List[FileRecord]", "kind": "member", "signature": "(self, owner_email: str, project_id: str)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "list_versions", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def list_versions(self, owner_email: str, project_id: str) -> List[VersionRecord]:$/", "language": "Python", "typeref": "typename:List[VersionRecord]", "kind": "member", "signature": "(self, owner_email: str, project_id: str)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "project_files_service", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^project_files_service = ProjectFilesService()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "restore_version", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def restore_version(self, owner_email: str, project_id: str, version_number: int) -> Tuple[L/", "language": "Python", "typeref": "typename:Tuple[List[FileRecord],VersionRecord]", "kind": "member", "signature": "(self, owner_email: str, project_id: str, version_number: int)", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "snapshot_version", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def snapshot_version($/", "language": "Python", "typeref": "typename:VersionRecord", "kind": "member", "signature": "( self, owner_email: str, project_id: str, description: Optional[str] )", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "update_file", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def update_file($/", "language": "Python", "typeref": "typename:Optional[FileRecord]", "kind": "member", "signature": "( self, owner_email: str, project_id: str, file_id: str, *, path: Optional[str], content: Optional[str], is_binary: Optional[bool] )", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "upsert_file_by_path", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    def upsert_file_by_path($/", "language": "Python", "typeref": "typename:FileRecord", "kind": "member", "signature": "( self, owner_email: str, project_id: str, path: str, content: str, is_binary: bool = False )", "scope": "ProjectFilesService", "scopeKind": "class"}, {"_type": "tag", "name": "versions", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/project_files_service.py", "pattern": "/^    versions: List[VersionRecord] = field(default_factory=list)$/", "language": "Python", "typeref": "typename:List[VersionRecord]", "kind": "variable", "scope": "ProjectState", "scopeKind": "class"}], "hash": "2f49f140c2e8cea1b75c0654b3be5116", "format-version": 4, "code-base-name": "lovable_backend_api", "filename": "lovable_backend_api/src/services/project_files_service.py", "fields": [{"name": "Dict[str, FileRecord] files", "scope": "ProjectState", "scopeKind": "class", "description": "unavailable"}, {"name": "Dict[str, str] files_by_path", "scope": "ProjectState", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_binary", "scope": "FileRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "project_files_service = ProjectFilesService()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "List[VersionRecord] versions", "scope": "ProjectState", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"39": ""}]}