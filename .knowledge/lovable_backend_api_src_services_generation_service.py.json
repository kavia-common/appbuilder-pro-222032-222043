{"is_source_file": true, "format": "Python", "description": "This file defines a mock implementation of a generation service, including classes and methods to simulate AI token streaming and file diffs for testing or development purposes.", "external_files": ["asyncio", "json", "uuid"], "external_methods": ["asyncio.sleep"], "published": ["GenerationService", "generation_service"], "classes": [{"name": "GenerationEvent", "description": "Represents individual events in the generation stream, such as tokens, file diffs, statuses, or errors."}, {"name": "_TaskState", "description": "Internal class maintaining the state for each generation task, including the queue of events."}, {"name": "GenerationService", "description": "Main class providing methods to create tasks, retrieve tasks, run mock generation, and stream events."}], "methods": [{"name": "str create_task( self, owner: str, prompt: str, project_id: Optional[str], chat_session_id: Optional[str] )", "description": "Initializes a new generation task with owner info, prompt, and optional project and chat session IDs, returning a unique task ID.", "scope": "GenerationService", "scopeKind": "class"}, {"name": "Optional[str] get_task_owner(self, task_id: str)", "description": "Returns the owner email of a specified task.", "scope": "GenerationService", "scopeKind": "class"}, {"name": "None run_task(self, task_id: str)", "description": "Simulates running a generation task, emitting a sequence of events like start status, token stream, file diffs, and completion or error signals.", "scope": "GenerationService", "scopeKind": "class"}, {"name": "AsyncIterator[str] stream_events(self, task_id: str)", "description": "Async generator yielding JSON strings representing events for a specific task until its completion.", "scope": "GenerationService", "scopeKind": "class"}, {"name": "List[str] _tokenize_prompt(self, prompt: str)", "description": "Naive prompt tokenizer splitting the prompt into small tokens.", "scope": "GenerationService", "scopeKind": "class"}, {"name": "List[dict] _mock_diffs(self, prompt: str)", "description": "Generates mock file diff events related to the prompt.", "scope": "GenerationService", "scopeKind": "class"}, {"name": "None __init__(self)", "scope": "GenerationService", "scopeKind": "class", "description": "unavailable"}], "calls": ["asyncio.sleep", "self._tasks.get", "state.queue.put", "json.dumps"], "search-terms": ["GenerationService", "mock generation", "stream_events", "simulate tokens", "file_diff", "asyncio.Queue", "task creation"], "state": 2, "file_id": 12, "knowledge_revision": 31, "git_revision": "", "ctags": [{"_type": "tag", "name": "GenerationEvent", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^class GenerationEvent:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "GenerationService", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^class GenerationService:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_TaskState", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^class _TaskState:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "GenerationService", "scopeKind": "class"}, {"_type": "tag", "name": "_mock_diffs", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    def _mock_diffs(self, prompt: str) -> List[dict]:$/", "language": "Python", "typeref": "typename:List[dict]", "kind": "member", "signature": "(self, prompt: str)", "scope": "GenerationService", "scopeKind": "class"}, {"_type": "tag", "name": "_tokenize_prompt", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    def _tokenize_prompt(self, prompt: str) -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "member", "signature": "(self, prompt: str)", "scope": "GenerationService", "scopeKind": "class"}, {"_type": "tag", "name": "chat_session_id", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    chat_session_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "_TaskState", "scopeKind": "class"}, {"_type": "tag", "name": "create_task", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    def create_task($/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "( self, owner: str, prompt: str, project_id: Optional[str], chat_session_id: Optional[str] )", "scope": "GenerationService", "scopeKind": "class"}, {"_type": "tag", "name": "done", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    done: bool = False$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "_TaskState", "scopeKind": "class"}, {"_type": "tag", "name": "error", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    error: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "_TaskState", "scopeKind": "class"}, {"_type": "tag", "name": "generation_service", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^generation_service = GenerationService()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get_task_owner", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    def get_task_owner(self, task_id: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "member", "signature": "(self, task_id: str)", "scope": "GenerationService", "scopeKind": "class"}, {"_type": "tag", "name": "project_id", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    project_id: Optional[str] = None$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "_TaskState", "scopeKind": "class"}, {"_type": "tag", "name": "prompt", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    prompt: str = \"\"$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "_TaskState", "scopeKind": "class"}, {"_type": "tag", "name": "queue", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    queue: asyncio.Queue = field(default_factory=asyncio.Queue)$/", "language": "Python", "typeref": "typename:asyncio.Queue", "kind": "variable", "scope": "_TaskState", "scopeKind": "class"}, {"_type": "tag", "name": "run_task", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    async def run_task(self, task_id: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, task_id: str)", "scope": "GenerationService", "scopeKind": "class"}, {"_type": "tag", "name": "stream_events", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/services/generation_service.py", "pattern": "/^    async def stream_events(self, task_id: str) -> AsyncIterator[str]:$/", "language": "Python", "typeref": "typename:AsyncIterator[str]", "kind": "member", "signature": "(self, task_id: str)", "scope": "GenerationService", "scopeKind": "class"}], "hash": "5e9478ed5b6e5b90dc9130999d34c913", "format-version": 4, "code-base-name": "lovable_backend_api", "filename": "lovable_backend_api/src/services/generation_service.py", "fields": [{"name": "Optional[str] chat_session_id", "scope": "_TaskState", "scopeKind": "class", "description": "unavailable"}, {"name": "bool done", "scope": "_TaskState", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] error", "scope": "_TaskState", "scopeKind": "class", "description": "unavailable"}, {"name": "generation_service = GenerationService()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] project_id", "scope": "_TaskState", "scopeKind": "class", "description": "unavailable"}, {"name": "str prompt", "scope": "_TaskState", "scopeKind": "class", "description": "unavailable"}, {"name": "asyncio.Queue queue", "scope": "_TaskState", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"31": ""}]}