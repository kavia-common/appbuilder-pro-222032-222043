{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI routes for serving project preview content, including an entry point and static files, as well as a WebSocket for reload events. It manages content type determination and fallback behavior when no entry file is found.", "external_files": ["src.routers.auth", "src.services.preview_service", "src.services.project_files_service"], "external_methods": ["get_current_user", "preview_service.read_file", "preview_service.register_ws", "preview_service.unregister_ws", "project_files_service.list_files"], "published": ["router"], "classes": [{"name": "PreviewIndexInfo", "description": "Model representing information about the served entry file, including its path and optional note."}], "methods": [{"name": "str _guess_content_type(path: str)", "description": "Determines the media type based on the file extension.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _find_default_entry(owner: str, project_id: str)", "description": "Finds the default entry file for a project based on common file names.", "scope": "", "scopeKind": ""}, {"name": "get_preview_entry( project_id: str = Path(..., description=\"Project ID\"), current_user: UserPublic = Depends(get_current_user), )", "description": "Endpoint to serve the main preview entry file or a fallback HTML if none found.", "scope": "", "scopeKind": ""}, {"name": "get_preview_file( project_id: str = Path(..., description=\"Project ID\"), path: str = \"\", current_user: UserPublic = Depends(get_current_user), )", "description": "Endpoint to serve a specific project file by path.", "scope": "", "scopeKind": ""}, {"name": "None ws_preview_reload(websocket: WebSocket, project_id: str = Path(...))", "description": "WebSocket endpoint for clients to receive reload notifications.", "scope": "", "scopeKind": ""}], "calls": ["preview_service.read_file", "project_files_service.list_files", "preview_service.register_ws", "preview_service.unregister_ws"], "search-terms": ["preview", "entry", "static files", "WebSocket reload", "project files", "FastAPI router"], "state": 2, "file_id": 19, "knowledge_revision": 54, "git_revision": "4d6116c3744385755434bf99b2a4f1d34b9385fe", "revision_history": [{"48": ""}, {"54": "4d6116c3744385755434bf99b2a4f1d34b9385fe"}], "ctags": [{"_type": "tag", "name": "PreviewIndexInfo", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^class PreviewIndexInfo(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_find_default_entry", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^def _find_default_entry(owner: str, project_id: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(owner: str, project_id: str)"}, {"_type": "tag", "name": "_guess_content_type", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^def _guess_content_type(path: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(path: str)"}, {"_type": "tag", "name": "get_preview_entry", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^async def get_preview_entry($/", "language": "Python", "kind": "function", "signature": "( project_id: str = Path(..., description=\"Project ID\"), current_user: UserPublic = Depends(get_current_user), )"}, {"_type": "tag", "name": "get_preview_file", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^async def get_preview_file($/", "language": "Python", "kind": "function", "signature": "( project_id: str = Path(..., description=\"Project ID\"), path: str = \"\", current_user: UserPublic = Depends(get_current_user), )"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^    note: Optional[str] = Field(None, description=\"Note about fallback behavior\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "PreviewIndexInfo", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^    path: str = Field(..., description=\"Resolved entry file path\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "PreviewIndexInfo", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^router = APIRouter($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ws_preview_reload", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^async def ws_preview_reload(websocket: WebSocket, project_id: str = Path(...)) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(websocket: WebSocket, project_id: str = Path(...))"}], "hash": "a2d8360c3d133d85e03441c4eda38af2", "format-version": 4, "code-base-name": "lovable_backend_api", "filename": "lovable_backend_api/src/routers/preview.py", "fields": [{"name": "Optional[str] note", "scope": "PreviewIndexInfo", "scopeKind": "class", "description": "unavailable"}, {"name": "str path", "scope": "PreviewIndexInfo", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(", "scope": "", "scopeKind": "", "description": "unavailable"}]}