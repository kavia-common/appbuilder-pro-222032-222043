{"is_source_file": true, "format": "Python", "description": "This source file defines FastAPI routes for handling project preview functionalities, including serving preview entries, static files, and websocket connections for reload notifications. It includes endpoint handlers, data models, and internal utility functions related to previewing project files.", "external_files": ["src.routers.auth", "src.services.preview_service", "src.services.project_files_service"], "external_methods": ["get_current_user", "preview_service.read_file", "preview_service.register_ws", "preview_service.unregister_ws", "project_files_service.list_files"], "published": ["get_preview_entry", "get_preview_file", "ws_preview_reload"], "classes": [{"name": "PreviewIndexInfo", "description": "Data model representing information about the preview index entry file, including its path and optional note."}], "methods": [{"name": "str _guess_content_type(path: str)", "description": "Determines the MIME type based on the file extension of the given path.", "scope": "", "scopeKind": ""}, {"name": "Optional[str] _find_default_entry(owner: str, project_id: str)", "description": "Attempts to locate a default project entry file using predefined candidate paths.", "scope": "", "scopeKind": ""}, {"name": "get_preview_entry( project_id: str = Path(..., description=\"Project ID\"), current_user: UserPublic = Depends(get_current_user), )", "description": "Endpoint to serve the project's preview index, or a fallback HTML if no index is found.", "scope": "", "scopeKind": ""}, {"name": "get_preview_file( project_id: str = Path(..., description=\"Project ID\"), path: str = \"\", current_user: UserPublic = Depends(get_current_user), )", "description": "Serves a specific static file from a project, given its path.", "scope": "", "scopeKind": ""}, {"name": "None ws_preview_reload(websocket: WebSocket, project_id: str = Path(...))", "description": "WebSocket endpoint for pushing reload notifications to preview clients upon file changes.", "scope": "", "scopeKind": ""}], "calls": ["project_files_service.list_files", "preview_service.read_file", "preview_service.register_ws", "preview_service.unregister_ws"], "search-terms": ["preview endpoint", "serve project files", "WebSocket reload", "preview index", "static file serving"], "state": 2, "file_id": 19, "knowledge_revision": 48, "git_revision": "", "ctags": [{"_type": "tag", "name": "PreviewIndexInfo", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^class PreviewIndexInfo(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_find_default_entry", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^def _find_default_entry(owner: str, project_id: str) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(owner: str, project_id: str)"}, {"_type": "tag", "name": "_guess_content_type", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^def _guess_content_type(path: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(path: str)"}, {"_type": "tag", "name": "get_preview_entry", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^async def get_preview_entry($/", "language": "Python", "kind": "function", "signature": "( project_id: str = Path(..., description=\"Project ID\"), current_user: UserPublic = Depends(get_current_user), )"}, {"_type": "tag", "name": "get_preview_file", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^async def get_preview_file($/", "language": "Python", "kind": "function", "signature": "( project_id: str = Path(..., description=\"Project ID\"), path: str = \"\", current_user: UserPublic = Depends(get_current_user), )"}, {"_type": "tag", "name": "note", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^    note: Optional[str] = Field(None, description=\"Note about fallback behavior\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "PreviewIndexInfo", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^    path: str = Field(..., description=\"Resolved entry file path\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "PreviewIndexInfo", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^router = APIRouter($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ws_preview_reload", "path": "/home/kavia/workspace/code-generation/appbuilder-pro-222032-222043/lovable_backend_api/src/routers/preview.py", "pattern": "/^async def ws_preview_reload(websocket: WebSocket, project_id: str = Path(...)) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(websocket: WebSocket, project_id: str = Path(...))"}], "hash": "e98a76a2e760676df22dd786ed9f53d1", "format-version": 4, "code-base-name": "lovable_backend_api", "filename": "lovable_backend_api/src/routers/preview.py", "fields": [{"name": "Optional[str] note", "scope": "PreviewIndexInfo", "scopeKind": "class", "description": "unavailable"}, {"name": "str path", "scope": "PreviewIndexInfo", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter(", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"48": ""}]}